<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>å¯†é‘°ä¸‹è¼‰èªªæ˜</title>
    <style>
        body{font-family:Arial,Helvetica,sans-serif;text-align:center;margin-top:30px;}
        .box{border:1px solid #ddd;padding:20px;margin:auto;width:80%;max-width:500px;}
        textarea{width:100%;height:120px;margin-top:10px;}
        .button{background:#4CAF50;color:#fff;padding:10px 20px;margin:10px;
                border:none;border-radius:5px;cursor:pointer;}
        .disabled{background:#bbb;cursor:not-allowed;}
    </style>
</head>
<body>
    <div class="box">
        <h2>ğŸ”‘ å¯†é‘°èªªæ˜</h2>
        <p>ä»¥ä¸‹æ˜¯ä½ ç›®å‰å¯é ˜å–çš„å¯†é‘°å…§å®¹ã€‚æŠŠå…§å®¹å…¨éƒ¨é¸ä¸­ä¸¦è¤‡è£½ï¼Œç„¶å¾Œåœ¨ Telegram è£¡æŠŠå®ƒè²¼çµ¦æ©Ÿå™¨äººå³å¯ç²å¾—ç§¯åˆ†ã€‚</p>

        <p><strong>å¯†é‘° 1ï¼ˆç²å¾— 8 åˆ†ï¼‰</strong></p>
        <textarea id="key1" placeholder="åœ¨è¿™é‡Œç²˜è´´å¯†é’¥ 1"></textarea>

        <p><strong>å¯†é‘° 2ï¼ˆç²å¾— 6 åˆ†ï¼‰</strong></p>
        <textarea id="key2" placeholder="åœ¨è¿™é‡Œç²˜è´´å¯†é’¥ 2"></textarea>

        <div id="status" style="margin-top:15px;"></div>

        <!-- æŒ‰éˆ•ï¼šæäº¤å¯†é‘° -->
        <button id="submit-key" class="button">æäº¤å¯†é‘°é ˜å–ç©åˆ†</button>
        <button id="submit-key-disabled" class="button disabled" disabled>å·²æäº¤</button>
    </div>

    <script>
        const btn = document.getElementById('submit-key');
        const disabledBtn = document.getElementById('submit-key-disabled');
        const statusDiv = document.getElementById('status');

        btn.addEventListener('click', async () => {
            btn.classList.add('disabled');
            btn.disabled = true;
            statusDiv.textContent = 'â³ æ­£åœ¨æäº¤...';

            // å–å¾—å…©å€‹ textarea çš„å…§å®¹
            const key1 = document.getElementById('key1').value.trim();
            const key2 = document.getElementById('key2').value.trim();

            // æŠŠ user_id ä»¥ hidden æ¬„ä½å‚³å›ä¼ºæœå™¨ï¼ˆä¼ºæœå™¨æœƒå¾ URL å–å¾—ï¼‰
            const url = new URL('/api/submit_key', location.origin);
            url.searchParams.set('key1', key1);
            url.searchParams.set('key2', key2);

            const response = await fetch(url, {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({user_id: new URLSearchParams(window.location.search).get('user_id') || '0'})
            });

            const data = await response.json();
            if (data.status === 'ok') {
                statusDiv.textContent = 'âœ… ç§¯åˆ†å·²ç™¼æ”¾ï¼Œæ„Ÿè¬ä½¿ç”¨ï¼';
            } else {
                statusDiv.textContent = 'âŒ ' + data.message;
            }
            // é‡æ–°å•Ÿç”¨æŒ‰éˆ•
            btn.classList.remove('disabled');
            btn.disabled = false;
        });
    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è·å–å¯†é’¥ - è·³è½¬ä¸­</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .container {
            background: white;
            border-radius: 20px;
            padding: 40px;
            max-width: 400px;
            width: 100%;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            text-align: center;
        }
        
        .icon {
            font-size: 60px;
            margin-bottom: 20px;
            animation: pulse 1.5s ease-in-out infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        h1 {
            color: #333;
            font-size: 24px;
            margin-bottom: 15px;
        }
        
        .subtitle {
            color: #666;
            font-size: 16px;
            margin-bottom: 30px;
            line-height: 1.6;
        }
        
        .countdown {
            font-size: 48px;
            font-weight: bold;
            color: #f5576c;
            margin: 20px 0;
        }
        
        .progress-bar {
            width: 100%;
            height: 6px;
            background: #e0e0e0;
            border-radius: 3px;
            overflow: hidden;
            margin-bottom: 20px;
        }
        
        .progress {
            height: 100%;
            background: linear-gradient(90deg, #f093fb, #f5576c);
            border-radius: 3px;
            animation: loading 3s linear forwards;
        }
        
        @keyframes loading {
            from { width: 0%; }
            to { width: 100%; }
        }
        
        .status {
            color: #888;
            font-size: 14px;
            margin-top: 10px;
        }
        
        .step {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin-top: 20px;
            text-align: left;
            font-size: 14px;
            color: #555;
        }
        
        .step-title {
            font-weight: bold;
            color: #333;
            margin-bottom: 8px;
        }
        
        .hidden {
            display: none;
        }
        
        .redirect-btn {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 16px;
            font-weight: bold;
            border-radius: 50px;
            cursor: pointer;
            margin-top: 20px;
            text-decoration: none;
            display: inline-block;
        }
        
        .back-link {
            margin-top: 20px;
            color: #f5576c;
            text-decoration: none;
            font-size: 14px;
            display: inline-block;
        }
    </style>
</head>
<body>
    <div class="container">
        <div id="loading-section">
            <div class="icon">ğŸ”</div>
            <h1>æ­£åœ¨è·å–å¯†é’¥...</h1>
            <p class="subtitle">è¯·ç¨å€™ï¼Œé¡µé¢å³å°†è·³è½¬</p>
            
            <div class="countdown" id="countdown">3</div>
            
            <div class="progress-bar">
                <div class="progress"></div>
            </div>
            
            <p class="status">æ­£åœ¨è¿æ¥æœåŠ¡å™¨...</p>
        </div>
        
        <div id="redirect-section" class="hidden">
            <div class="icon">âœ…</div>
            <h1>å³å°†è·³è½¬</h1>
            <p class="subtitle">å¦‚æœæ²¡æœ‰è‡ªåŠ¨è·³è½¬ï¼Œè¯·ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®</p>
            
            <a href="#" id="manual-redirect" class="redirect-btn">ç‚¹å‡»è·³è½¬</a>
            
            <div class="step">
                <div class="step-title">ğŸ“Œ è·å–å¯†é’¥æ­¥éª¤ï¼š</div>
                1. ä¿å­˜æ–‡ä»¶åˆ°ç½‘ç›˜<br>
                2. æŸ¥çœ‹æ–‡ä»¶åï¼ˆæ–‡ä»¶åå³å¯†é’¥ï¼‰<br>
                3. å¤åˆ¶å¯†é’¥å‘é€ç»™æœºå™¨äºº
            </div>
        </div>
        
        <a href="https://t.me/WeeBearbot" class="back-link">â† è¿”å›æœºå™¨äºº</a>
    </div>
    
    <script>
        // API åŸºç¡€åœ°å€
        const API_BASE = 'web-production-ef660.up.railway.app';
        
        // Monetag ç›´é“¾
        const MONETAG_LINK = 'https://otieu.com/4/10489998';
        
        // å¯†é’¥é“¾æ¥ç¼–å·
        const LINK_NUM = 2;
        
        let countdown = 3;
        let secretLink = null;
        
        // è·å–å¯†é’¥é“¾æ¥
        async function getSecretLink() {
            try {
                const response = await fetch(`${API_BASE}/api/secret/link/${LINK_NUM}`);
                const data = await response.json();
                
                if (data.success) {
                    secretLink = data.link;
                    return true;
                }
                return false;
            } catch (error) {
                console.error('Error fetching secret link:', error);
                return false;
            }
        }
        
        // å¼€å§‹è·³è½¬æµç¨‹
        async function startRedirect() {
            // å…ˆè·å–å¯†é’¥é“¾æ¥
            const linkReady = await getSecretLink();
            
            if (!linkReady) {
                document.querySelector('.status').textContent = 'âŒ é“¾æ¥è·å–å¤±è´¥ï¼Œè¯·è¿”å›é‡è¯•';
                return;
            }
            
            // æ‰“å¼€ Monetag å¹¿å‘Šé“¾æ¥
            window.open(MONETAG_LINK, '_blank');
            
            // å¼€å§‹å€’è®¡æ—¶
            const countdownElement = document.getElementById('countdown');
            const statusElement = document.querySelector('.status');
            
            const timer = setInterval(() => {
                countdown--;
                countdownElement.textContent = countdown;
                
                if (countdown === 2) {
                    statusElement.textContent = 'å¹¿å‘ŠåŠ è½½ä¸­...';
                } else if (countdown === 1) {
                    statusElement.textContent = 'å³å°†è·³è½¬åˆ°ç½‘ç›˜...';
                }
                
                if (countdown <= 0) {
                    clearInterval(timer);
                    
                    // æ˜¾ç¤ºè·³è½¬åŒºåŸŸ
                    document.getElementById('loading-section').classList.add('hidden');
                    document.getElementById('redirect-section').classList.remove('hidden');
                    
                    // è®¾ç½®æ‰‹åŠ¨è·³è½¬é“¾æ¥
                    document.getElementById('manual-redirect').href = secretLink;
                    
                    // è‡ªåŠ¨è·³è½¬åˆ°å¯†é’¥é“¾æ¥
                    window.location.href = secretLink;
                }
            }, 1000);
        }
        
        // é¡µé¢åŠ è½½å®Œæˆåå¼€å§‹
        window.onload = startRedirect;
    </script>
</body>
</html>
